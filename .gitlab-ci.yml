image: archlinux/base


stages:
    - format
    - builds
    - tests


format:
    stage: format
    before_script:
        - pacman -Sy --noconfirm
        - pacman -S rust diffutils gawk grep --noconfirm
    script:
        - for i in $( du -a . | awk '{print $2}' | grep -i "[.]rs$" ); do
        - cp $i temp.txt
        - rustfmt $i
        - cmp $i temp.txt
        - done


monoalphabetic-substitution-encipher-build:
    stage: builds
    before_script:
        - pacman -Sy --noconfirm
        - pacman -S base-devel libffi rust --noconfirm
    script:
        - cd monoalphabetic-substitution-cipher/encipher
        - cargo build


monoalphabetic-substitution-cipher-frequency-analysis-build:
    stage: builds
    before_script:
        - pacman -Sy --noconfirm
        - pacman -S base-devel libffi rust --noconfirm
    script:
        - cd monoalphabetic-substitution-cipher/frequency-analysis
        - cargo build


monoalphabetic-substitution-encipher-tests:
    stage: tests
    before_script:
        - pacman -Sy --noconfirm
        - pacman -S base-devel libffi rust --noconfirm
    script:
        - cd monoalphabetic-substitution-cipher/encipher
        - cargo test


monoalphabetic-substitution-cipher-frequency-analysis-tests:
    stage: tests
    before_script:
        - pacman -Sy --noconfirm
        - pacman -S base-devel libffi rust --noconfirm
    script:
        - cd monoalphabetic-substitution-cipher/frequency-analysis
        - cargo test
